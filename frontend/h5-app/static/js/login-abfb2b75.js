import{X as h,Z as E,a4 as Z,a8 as G,a9 as J,d as C,ao as O,P as $,C as W,a1 as X,b as t,a3 as K,r as p,a as B,c as Q,w as d,am as Y,T as ee,B as P,u as oe,O as te,k as ae,J as se,o as le,f as ne,e as m,s as ie,t as g,ap as re,v as de,aq as ue,n as F,h as H,ar as ce,_ as me}from"./index-b744bed0.js";/* empty css              *//* empty css              */import{C as pe}from"./index-bd70418e.js";import{F as fe}from"./index-ede2df1d.js";import{d as ve}from"./favicon-b4446a02.js";import{T as ge,a as _e}from"./index-b6f26b7c.js";import{I as we}from"./index-beccc506.js";import{F as he}from"./index-6f272d29.js";import"./use-tab-status-e5f41a03.js";import"./index-515de819.js";import"./index-3959dc36.js";function ye(e,i){const{days:n}=i;let{hours:u,minutes:r,seconds:a,milliseconds:l}=i;if(e.includes("DD")?e=e.replace("DD",h(n)):u+=n*24,e.includes("HH")?e=e.replace("HH",h(u)):r+=u*60,e.includes("mm")?e=e.replace("mm",h(r)):a+=r*60,e.includes("ss")?e=e.replace("ss",h(a)):l+=a*1e3,e.includes("S")){const f=h(l,3);e.includes("SSS")?e=e.replace("SSS",f):e.includes("SS")?e=e.replace("SS",f.slice(0,2)):e=e.replace("S",f.charAt(0))}return e}const[be,Se]=E("count-down"),$e={time:Z(0),format:G("HH:mm:ss"),autoStart:J,millisecond:Boolean};var Ce=C({name:be,props:$e,emits:["change","finish"],setup(e,{emit:i,slots:n}){const{start:u,pause:r,reset:a,current:l}=O({time:+e.time,millisecond:e.millisecond,onChange:w=>i("change",w),onFinish:()=>i("finish")}),f=$(()=>ye(e.format,l.value)),_=()=>{a(+e.time),e.autoStart&&u()};return W(()=>e.time,_,{immediate:!0}),X({start:u,pause:r,reset:_}),()=>t("div",{role:"timer",class:Se()},[n.default?n.default(l.value):f.value])}});const ke=K(Ce);const q=C({__name:"LoadingButton",props:{loadingClick:{type:Function,default:()=>Promise}},setup(e){const i=e,n=p(!1);async function u(){try{n.value=!0,await i.loadingClick(),n.value=!1}catch(r){console.error(r),n.value=!1}}return(r,a)=>{const l=P;return B(),Q(l,ee(r.$attrs,{loading:n.value,onClick:u}),{default:d(()=>[Y(r.$slots,"default")]),_:3},16,["loading"])}}}),Ve={class:"main-container h-[100vh]"},Re={class:"fixed top-0 right-0 p-4 flex items-center z-10"},De={class:"h-[40vh] flex flex-col justify-center items-center"},Fe={class:"mt-6 text-xl font-bold"},He={class:"flex justify-center items-center"},qe={class:"--van-gray-1"},Be={class:"--van-gray-1"},Pe={class:"mt-[40px]"},Ie={class:"text-left text-xs text-gray-500 mt-4"},Ue={class:"mt-[40px]"},xe={class:"i18n-notice mt-8 p-4 mx-4 rounded-lg text-center text-sm bg-gray-100 border border-gray-200"},Te=C({__name:"login",setup(e){oe();const i=te(),n=ae(),u=se(),r=p(0),a=p({email:"",code:""}),l=p({account:"",password:""}),f=$(()=>a.value.email.trim()!==""&&a.value.code.trim()!==""&&/^[\w-]+(\.[\w-]+)*@[\w-]+(\.[\w-]+)+$/.test(a.value.email)&&/^\d{6}$/.test(a.value.code)),_=$(()=>l.value.account.trim()!==""&&l.value.password.trim()!==""),w=p(),k=p(),y=p(!1),I=p(60*1e3),S=p(),U=()=>{var o;(o=S.value)==null||o.start(),y.value=!0},x=()=>{var o;(o=S.value)==null||o.reset(),y.value=!1},T=()=>{x()},L=async()=>{var o;await((o=w.value)==null?void 0:o.validate("email")),U(),ce({email:a.value.email})},M=async()=>{var o,s,v;console.log("验证码登录提交"),await((o=w.value)==null?void 0:o.validate()),await u.LoginAction(a.value),await n.replace((s=i.query)!=null&&s.redirect?decodeURIComponent((v=i.query)==null?void 0:v.redirect):"/")},N=async()=>{var o,s,v;await((o=k.value)==null?void 0:o.validate()),await u.LoginWithPasswordAction(l.value),await n.replace((s=i.query)!=null&&s.redirect?decodeURIComponent((v=i.query)==null?void 0:v.redirect):"/")};return le(()=>{console.log("route",i),console.log("router-onMounted",n)}),(o,s)=>{const v=we,b=fe,A=ke,z=P,V=pe,R=he,D=_e,j=ge;return B(),ne("div",Ve,[m("div",Re,[t(re,{class:"mr-2"})]),m("div",De,[t(v,{round:"",width:"30vw",height:"30vw",src:ie(ve)},null,8,["src"]),m("h2",Fe,g(o.$t("login.welcome")),1)]),m("div",null,[t(j,{active:r.value,"onUpdate:active":s[4]||(s[4]=c=>r.value=c),animated:""},{default:d(()=>[t(D,{title:o.$t("login.tabs.codeLogin")},{default:d(()=>[t(R,{ref_key:"formRef",ref:w},{default:d(()=>[t(V,{inset:""},{default:d(()=>[t(b,{modelValue:a.value.email,"onUpdate:modelValue":s[0]||(s[0]=c=>a.value.email=c),modelModifiers:{trim:!0},name:"email",required:"",type:"email",autocomplete:"off",placeholder:o.$t("login.form.email"),class:"with-border",rules:[{required:!0,pattern:/^[\w-]+(\.[\w-]+)*@[\w-]+(\.[\w-]+)+$/,message:o.$t("login.form.emailRule")}]},null,8,["modelValue","placeholder","rules"]),t(b,{modelValue:a.value.code,"onUpdate:modelValue":s[1]||(s[1]=c=>a.value.code=c),modelModifiers:{trim:!0},name:"code",placeholder:o.$t("login.form.code"),clearable:"",type:"digit",maxlength:"6",autocomplete:"off",class:"with-border",rules:[{required:!0,pattern:/^\d{6}$/,message:o.$t("login.form.codeRule")}]},{button:d(()=>[t(z,{onClick:L,size:"small",type:"primary"},{default:d(()=>[m("div",He,[m("span",qe,g(y.value?o.$t("login.form.sent"):o.$t("login.form.sendCode")),1),de(t(A,{ref_key:"countDownRef",ref:S,onFinish:T,time:I.value,"auto-start":!1,format:"ss"},{default:d(({seconds:c})=>[m("span",Be,g(`(${c}s)`),1)]),_:1},8,["time"]),[[ue,y.value]])])]),_:1})]),_:1},8,["modelValue","placeholder","rules"])]),_:1}),m("div",Pe,[t(q,{"rounded-md":"",block:"",type:"primary","native-type":"submit",disabled:!f.value,class:F({"opacity-50 cursor-not-allowed":!f.value}),loadingClick:M},{default:d(()=>[H(g(o.$t("login.form.loginButton")),1)]),_:1},8,["disabled","class"]),m("div",Ie,g(o.$t("login.form.autoRegisterTip")),1)])]),_:1},512)]),_:1},8,["title"]),t(D,{title:o.$t("login.tabs.passwordLogin")},{default:d(()=>[t(R,{ref_key:"pwdFormRef",ref:k},{default:d(()=>[t(V,{inset:""},{default:d(()=>[t(b,{modelValue:l.value.account,"onUpdate:modelValue":s[2]||(s[2]=c=>l.value.account=c),modelModifiers:{trim:!0},name:"account",required:"",autocomplete:"off",placeholder:o.$t("login.form.account"),class:"with-border",rules:[{required:!0,message:o.$t("login.form.accountRule")}]},null,8,["modelValue","placeholder","rules"]),t(b,{modelValue:l.value.password,"onUpdate:modelValue":s[3]||(s[3]=c=>l.value.password=c),modelModifiers:{trim:!0},name:"password",type:"password",placeholder:o.$t("login.form.password"),autocomplete:"off",class:"with-border",rules:[{required:!0,message:o.$t("login.form.passwordRule")}]},null,8,["modelValue","placeholder","rules"])]),_:1}),m("div",Ue,[t(q,{"rounded-md":"",block:"",type:"primary","native-type":"submit",disabled:!_.value,class:F({"opacity-50 cursor-not-allowed":!_.value}),loadingClick:N},{default:d(()=>[H(g(o.$t("login.form.loginButton")),1)]),_:1},8,["disabled","class"])])]),_:1},512)]),_:1},8,["title"])]),_:1},8,["active"])]),m("div",xe,g(o.$t("login.i18nNotice")),1)])}}});const Xe=me(Te,[["__scopeId","data-v-95776a25"]]);export{Xe as default};
