import{d as R,u as H,k as U,r as h,o as Y,l as J,f as l,e as o,b as a,w as r,m as w,F as f,p as K,B as O,q as Q,a as i,s as I,h as _,t as c,g as C,v as W,c as D,j as X,x as Z,L as ee,I as te,_ as se}from"./index-b744bed0.js";import{C as oe,R as ne}from"./index-10ea773f.js";import{E as ae}from"./index-479e4c76.js";import{S as ie}from"./index-c701fe21.js";import{P as re}from"./PullDownRefreshContainer-eb4714b8.js";import{u as ce}from"./useLike-4f904da7.js";import{s as le}from"./function-call-69531997.js";import{I as de}from"./index-beccc506.js";import"./index-ae057aef.js";import"./index-58f473f0.js";import"./index-515de819.js";const me="/static/png/group_bg-1245397b.png",pe={class:"bg-[--color-block-background] min-h-screen pb-[50px]"},ue={key:0,class:"mt-[15px]"},_e={key:1,class:"flex flex-col items-center justify-center py-[30px]"},ve={key:2,class:"blog-list"},he=["onClick"],fe={class:"bg-[--color-background-3] main-container py-[10px] relative"},ge={class:"flex"},ke={class:"flex flex-col justify-center ml-[10px] text-[12px]"},ye={class:"font-bold"},xe={class:"--van-gray-6"},we={class:"mt-[10px] flex flex-col"},Ce={class:"font-bold"},Le={class:"van-multi-ellipsis--l3"},$e={class:"flex mt-[10px]"},Se=["onClick"],Be={class:"ml-[5px]"},Ie={class:"flex items-center ml-[20px]"},De={class:"ml-[5px]"},Re={class:"fab-container"},Fe=R({name:"Group"}),Pe=R({...Fe,setup(je){const{t:F}=H(),g=U(),v=h(),d=h([]),k=h(!1);h(0);const{handleLike:P,initLikeStatus:j}=ce(),z=async e=>{var s;console.log("调用 loadBlogList，参数:",e),k.value=e.current===1;try{const n=await K.get("/app/blog/listBlogs",e);if(console.log("API响应:",n),n.code===200&&n.data){const m=n.data.records||[];if(e.current===1)d.value=m;else{const p=new Set(d.value.map(u=>u.id)),y=m.filter(u=>!p.has(u.id));d.value=[...d.value,...y]}return d.value.forEach(p=>{p.isLiked&&j(p.id,!0)}),(s=v.value)==null||s.setFinished(d.value.length>=(n.data.total||0)),!0}else return!1}catch(n){return console.error("获取博客列表错误:",n),!1}finally{k.value=!1}},b=(e,s)=>{const n=e.map(m=>m.url);le({images:n,startPosition:s})},T=e=>{try{g.push(`/blog/detail/${e}`)}catch(s){console.error("导航失败:",s)}},L=()=>{console.log("点击了创建帖子按钮");try{g.push({name:"CreatePost"})}catch(e){console.error("导航到创建帖子页面失败:",e),g.push("/post/create").catch(s=>{console.error("路径导航也失败了:",s),Z(F("community.navigationFailed"))})}},E=()=>{L()},M=e=>{if(!e)return"";const s=new Date(e);return`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}-${String(s.getDate()).padStart(2,"0")} ${String(s.getHours()).padStart(2,"0")}:${String(s.getMinutes()).padStart(2,"0")}`},$=e=>e===1?"80vw":e===2||e===4?"40vw":"25vw",N=e=>e===1?24:e===2||e===4?12:8,V=()=>{v.value&&v.value.onRefresh()};return Y(()=>{console.log("Group组件已挂载")}),J(()=>{console.log("Group组件被激活"),V()}),(e,s)=>{const n=ee,m=de,p=ie,y=ae,u=O,G=oe,q=ne,S=te,A=Q("on-click-remove-class");return i(),l(f,null,[o("div",pe,[a(re,{request:z,ref_key:"pullDownRefreshContainerRef",ref:v,class:"min-h-[70vh]"},{default:r(()=>[a(m,{src:I(me),class:"w-full"},{error:r(()=>[_(c(e.$t("common.loadFailed")),1)]),loading:r(()=>[a(n,{type:"spinner",size:"20"})]),_:1},8,["src"]),k.value?(i(),l("div",ue,[(i(),l(f,null,C(3,t=>o("div",{key:t,class:"bg-[--color-background-3] main-container py-[10px] mb-[15px]"},[a(p,{title:"",avatar:"",row:3})])),64))])):d.value.length===0?(i(),l("div",_e,[a(y,{description:e.$t("community.noBlogContent")},null,8,["description"]),a(u,{type:"primary",size:"small",class:"mt-[15px]",onClick:E},{default:r(()=>[_(c(e.$t("community.publish")),1)]),_:1})])):(i(),l("div",ve,[(i(!0),l(f,null,C(d.value,t=>(i(),l("div",{key:t.id,class:"mt-[15px] blog-item",onClick:x=>T(t.id)},[o("div",fe,[o("div",ge,[a(m,{round:"",width:"12vw",height:"12vw",src:t.avatar||"https://fastly.jsdelivr.net/npm/@vant/assets/cat.jpeg"},{error:r(()=>[_(c(e.$t("common.loadFailed")),1)]),loading:r(()=>[a(n,{type:"spinner",size:"20"})]),_:2},1032,["src"]),o("div",ke,[o("div",ye,c(t.nickname||`${e.$t("community.user")}${t.userId}`),1),o("div",xe,c(M(t.createTime)),1)])]),o("div",we,[o("div",Ce,c(t.title),1),W((i(),l("div",Le,[_(c(t.content),1)])),[[A,["van-multi-ellipsis--l3"]]]),t.imageList&&t.imageList.length>0?(i(),D(q,{key:0,class:"mt-[10px]"},{default:r(()=>[(i(!0),l(f,null,C(t.imageList,(x,B)=>(i(),D(G,{span:N(t.imageList.length),key:B,class:"p-[2px]"},{default:r(()=>[a(m,{width:$(t.imageList.length),height:$(t.imageList.length),src:x.url,onClick:w(ze=>b(t.imageList,B),["stop"])},{error:r(()=>[_(c(e.$t("common.loadFailed")),1)]),loading:r(()=>[a(n,{type:"spinner",size:"20"})]),_:2},1032,["width","height","src","onClick"])]),_:2},1032,["span"]))),128))]),_:2},1024)):X("",!0),o("div",$e,[o("div",{class:"flex items-center",onClick:w(x=>I(P)(t),["stop"])},[a(S,{name:t.isLiked?"good-job":"good-job-o",color:t.isLiked?"#ff5000":"",size:"20"},null,8,["name","color"]),o("div",Be,c(t.liked||0),1)],8,Se),o("div",Ie,[a(S,{name:"comment-o",size:"20"}),o("div",De,c(t.comments||0),1)])])])])],8,he))),128))]))]),_:1},512)]),o("div",Re,[a(u,{round:"",type:"primary",icon:"plus",onClick:w(L,["stop"])})])],64)}}});const Ye=se(Pe,[["__scopeId","data-v-49189626"]]);export{Ye as default};
