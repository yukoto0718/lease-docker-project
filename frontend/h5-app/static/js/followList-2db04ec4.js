import{d as M,u as G,k as H,r as y,C as J,f as r,b as s,s as K,e as k,w as i,av as O,a as c,h as C,t as h,F as B,g as j,m as $,x as I,aw as Q,L as W,B as X,_ as Y}from"./index-b744bed0.js";/* empty css              *//* empty css              */import{E as Z}from"./index-479e4c76.js";import"./index-ede2df1d.js";import{S as ee}from"./index-4f7c4551.js";import{P as q}from"./PullDownRefreshContainer-eb4714b8.js";import{c as te,e as oe,h as le,f as se,u as ae}from"./index-58f473f0.js";import{T as ne,a as re}from"./index-b6f26b7c.js";import{I as ie}from"./index-beccc506.js";import"./index-ae057aef.js";import"./use-tab-status-e5f41a03.js";import"./index-515de819.js";import"./index-3959dc36.js";const ce={class:"follow-list bg-[--color-block-background] min-h-screen pb-[80px]"},ue={class:"px-[15px] py-[10px]"},de={key:0,class:"py-[20px]"},fe={key:1,class:"flex flex-col items-center justify-center py-[30px]"},me={key:2,class:"user-list"},ve=["onClick"],pe={class:"flex-1 ml-[15px]"},we={class:"font-bold"},he={key:0,class:"py-[20px]"},_e={key:1,class:"flex flex-col items-center justify-center py-[30px]"},ye={key:2,class:"user-list"},ke=["onClick"],ge={class:"flex-1 ml-[15px]"},xe={class:"font-bold"},Ce={key:0,class:"py-[20px]"},$e={key:1,class:"flex flex-col items-center justify-center py-[30px]"},Fe={key:2,class:"user-list"},Ie=["onClick"],Re={class:"flex-1 ml-[15px]"},be={class:"font-bold"},Ue=M({name:"FollowList"}),Le=M({...Ue,setup(Te){const{t:f}=G(),b=H(),v=y(!1),m=y("mutual"),F=y(""),l=y([]),U="https://fastly.jsdelivr.net/npm/@vant/assets/cat.jpeg",g=y(),x=y(),R=y(),N=async e=>{var o;v.value=e.current===1;try{const a={...e,keyword:F.value},n=await te(a);if(n.code===200&&n.data){const u=n.data.records||[];if(e.current===1)l.value=u;else{const p=new Set(l.value.map(d=>d.userId)),w=u.filter(d=>!p.has(d.userId));l.value=[...l.value,...w]}return(o=g.value)==null||o.setFinished(l.value.length>=(n.data.total||0)),!0}else return!1}catch(a){return console.error("获取互相关注列表错误:",a),!1}finally{v.value=!1}},V=async e=>{var o;v.value=e.current===1;try{const a={...e,keyword:F.value},n=await oe(a);if(n.code===200&&n.data){const u=n.data.records||[];if(e.current===1)l.value=u;else{const p=new Set(l.value.map(d=>d.userId)),w=u.filter(d=>!p.has(d.userId));l.value=[...l.value,...w]}return(o=x.value)==null||o.setFinished(l.value.length>=(n.data.total||0)),!0}else return!1}catch(a){return console.error("获取关注列表错误:",a),!1}finally{v.value=!1}},D=async e=>{var o;v.value=e.current===1;try{const a={...e,keyword:F.value},n=await le(a);if(n.code===200&&n.data){const u=n.data.records||[];if(e.current===1)l.value=u;else{const p=new Set(l.value.map(d=>d.userId)),w=u.filter(d=>!p.has(d.userId));l.value=[...l.value,...w]}return(o=R.value)==null||o.setFinished(l.value.length>=(n.data.total||0)),!0}else return!1}catch(a){return console.error("获取粉丝列表错误:",a),!1}finally{v.value=!1}},E=()=>{var e,o,a;m.value==="mutual"?(e=g.value)==null||e.onRefresh():m.value==="following"?(o=x.value)==null||o.onRefresh():m.value==="followers"&&((a=R.value)==null||a.onRefresh())};J(m,e=>{var o,a,n;l.value=[],e==="mutual"?(o=g.value)==null||o.onRefresh():e==="following"?(a=x.value)==null||a.onRefresh():e==="followers"&&((n=R.value)==null||n.onRefresh())});const P=async e=>{try{e.mutualFollow=!0,await se(e.userId),I(f("community.post.followSuccess")),m.value==="followers"&&setTimeout(()=>{g.value&&g.value.onRefresh()},500)}catch(o){console.error("关注操作错误:",o),e.mutualFollow=!1,I(f("operationFailed"))}},L=async e=>{Q({title:f("follow.unfollowTitle"),message:f("follow.unfollowConfirm",{nickname:e.nickname||f("community.user")+e.userId}),showCancelButton:!0,confirmButtonText:f("common.confirm"),cancelButtonText:f("common.cancel")}).then(async()=>{try{e.mutualFollow=!1,await ae(e.userId),I(f("community.post.unfollowSuccess")),(m.value==="following"||m.value==="mutual")&&(l.value=l.value.filter(o=>o.userId!==e.userId)),m.value==="mutual"&&setTimeout(()=>{x.value&&x.value.onRefresh()},500)}catch{e.mutualFollow=!0,I(f("operationFailed"))}}).catch(()=>{})},T=e=>{b.push(`/blog/userSpace/${e}`)},S=e=>{if(!e||!e.userId){I(f("community.chatStartFailedInvalidUser"));return}b.push({path:`/chat/${e.userId}`,query:{nickname:e.nickname||`User${e.userId}`,avatar:e.avatarUrl||""}})};return(e,o)=>{const a=O,n=ee,u=W,p=Z,w=ie,d=X,z=re,A=ne;return c(),r("div",ce,[s(a,{title:e.$t("follow.followList"),"left-arrow":"",onClickLeft:o[0]||(o[0]=t=>K(b).back())},null,8,["title"]),k("div",ue,[s(n,{modelValue:F.value,"onUpdate:modelValue":o[1]||(o[1]=t=>F.value=t),placeholder:e.$t("follow.searchUser"),onSearch:E,shape:"round"},null,8,["modelValue","placeholder"])]),s(A,{active:m.value,"onUpdate:active":o[2]||(o[2]=t=>m.value=t),sticky:""},{default:i(()=>[s(z,{title:e.$t("follow.mutualFollows"),name:"mutual"},{default:i(()=>[s(q,{request:N,ref_key:"mutualRefreshContainerRef",ref:g,class:"min-h-[70vh]"},{default:i(()=>[v.value?(c(),r("div",de,[s(u,{size:"24px",vertical:""},{default:i(()=>[C(h(e.$t("common.loading")),1)]),_:1})])):l.value.length===0?(c(),r("div",fe,[s(p,{description:e.$t("follow.noMutualFollows")},null,8,["description"])])):(c(),r("div",me,[(c(!0),r(B,null,j(l.value,t=>(c(),r("div",{key:t.userId,class:"user-item flex items-center p-[15px] bg-white mb-[10px] mx-[15px] rounded-[8px]",onClick:_=>S(t)},[s(w,{round:"",width:"15vw",height:"15vw",src:t.avatarUrl||U,onClick:$(_=>T(t.userId),["stop"])},{loading:i(()=>[s(u,{type:"spinner",size:"20"})]),_:2},1032,["src","onClick"]),k("div",pe,[k("div",we,h(t.nickname||`User${t.userId}`),1)]),s(d,{round:"",size:"small",type:"default",onClick:$(_=>L(t),["stop"])},{default:i(()=>[C(h(e.$t("community.post.followed")),1)]),_:2},1032,["onClick"])],8,ve))),128))]))]),_:1},512)]),_:1},8,["title"]),s(z,{title:e.$t("follow.following"),name:"following"},{default:i(()=>[s(q,{request:V,ref_key:"followingRefreshContainerRef",ref:x,class:"min-h-[70vh]"},{default:i(()=>[v.value?(c(),r("div",he,[s(u,{size:"24px",vertical:""},{default:i(()=>[C(h(e.$t("common.loading")),1)]),_:1})])):l.value.length===0?(c(),r("div",_e,[s(p,{description:e.$t("follow.noFollowing")},null,8,["description"])])):(c(),r("div",ye,[(c(!0),r(B,null,j(l.value,t=>(c(),r("div",{key:t.userId,class:"user-item flex items-center p-[15px] bg-white mb-[10px] mx-[15px] rounded-[8px]",onClick:_=>S(t)},[s(w,{round:"",width:"15vw",height:"15vw",src:t.avatarUrl||U,onClick:$(_=>T(t.userId),["stop"])},{loading:i(()=>[s(u,{type:"spinner",size:"20"})]),_:2},1032,["src","onClick"]),k("div",ge,[k("div",xe,h(t.nickname||`User${t.userId}`),1)]),s(d,{round:"",size:"small",type:"default",onClick:$(_=>L(t),["stop"])},{default:i(()=>[C(h(e.$t("community.post.followed")),1)]),_:2},1032,["onClick"])],8,ke))),128))]))]),_:1},512)]),_:1},8,["title"]),s(z,{title:e.$t("follow.followers"),name:"followers"},{default:i(()=>[s(q,{request:D,ref_key:"followerRefreshContainerRef",ref:R,class:"min-h-[70vh]"},{default:i(()=>[v.value?(c(),r("div",Ce,[s(u,{size:"24px",vertical:""},{default:i(()=>[C(h(e.$t("common.loading")),1)]),_:1})])):l.value.length===0?(c(),r("div",$e,[s(p,{description:e.$t("follow.noFollowers")},null,8,["description"])])):(c(),r("div",Fe,[(c(!0),r(B,null,j(l.value,t=>(c(),r("div",{key:t.userId,class:"user-item flex items-center p-[15px] bg-white mb-[10px] mx-[15px] rounded-[8px]",onClick:_=>S(t)},[s(w,{round:"",width:"15vw",height:"15vw",src:t.avatarUrl||U,onClick:$(_=>T(t.userId),["stop"])},{loading:i(()=>[s(u,{type:"spinner",size:"20"})]),_:2},1032,["src","onClick"]),k("div",Re,[k("div",be,h(t.nickname||`User${t.userId}`),1)]),s(d,{round:"",size:"small",type:t.mutualFollow?"default":"primary",plain:!t.mutualFollow,onClick:$(_=>t.mutualFollow?L(t):P(t),["stop"])},{default:i(()=>[C(h(t.mutualFollow?e.$t("community.post.followed"):e.$t("community.post.follow")),1)]),_:2},1032,["type","plain","onClick"])],8,Ie))),128))]))]),_:1},512)]),_:1},8,["title"])]),_:1},8,["active"])])}}});const Je=Y(Le,[["__scopeId","data-v-734756ed"]]);export{Je as default};
