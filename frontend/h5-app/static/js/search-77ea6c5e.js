import{d as H,u as G,r as y,o as K,a as o,c as w,w as i,b as n,e as r,f as h,g as b,n as L,t as d,F as C,h as v,B as Q,D as U,i as W,_ as B,j as X}from"./index-b744bed0.js";import{C as Y,R as Z}from"./index-10ea773f.js";import{g as ee,a as se,b as te,c as ae,d as le}from"./index-25c840a0.js";import{g as ce}from"./constEnums-5f5dc902.js";import{P as ie}from"./PullDownRefreshContainer-eb4714b8.js";import{_ as ne}from"./RoomCard.vue_vue_type_script_setup_true_lang-7636b39d.js";import"./index-beccc506.js";import"./index-ae057aef.js";import"./index-479e4c76.js";const oe="/static/jpg/banner-9b2f28a8.jpg",re={class:"comment-padding"},de={class:"flex flex-row h-[30vh] mt-[5px]"},ue={class:"basis-1/3",style:{overflow:"scroll"}},fe=["onClick"],ve={class:"basis-1/3",style:{overflow:"scroll"}},he=["onClick"],pe={class:"basis-1/3",style:{overflow:"scroll"}},_e=["onClick"],ye={class:"flex comment-padding justify-between my-[10px]"},ke={class:"comment-padding"},Ce={class:"flex comment-padding justify-between my-[10px]"},me={class:"comment-padding"},be={class:"flex comment-padding justify-between my-[10px]"},Le={class:"comment-padding"},ge={class:"flex comment-padding justify-between my-[10px]"},Ie=H({__name:"SearchBar",props:{confirmCallback:{type:Function,default:()=>({})}},setup(j){const{t:g}=G(),m=j,p=y(),l=y({provinceId:"",cityId:"",districtId:"",minRent:"",maxRent:"",paymentTypeId:"",orderType:""}),t=y({provinceList:[],cityList:[],oldCityListInfo:{provinceId:"",cityList:[]},districtList:[],oldDistrictList:{cityId:"",districtList:[]}}),u=(e,a)=>{if(a===0){if(e.isCheck){e.isCheck=!e.isCheck,l.value.provinceId="",l.value.cityId="",l.value.districtId="",t.value.cityList.forEach(c=>{c.isCheck=!1}),t.value.districtList.forEach(c=>{c.isCheck=!1});return}t.value.provinceList.forEach(c=>{c.isCheck=!1}),e.isCheck=!e.isCheck,l.value.provinceId=e.id,J()}else if(a===1){if(e.isCheck){e.isCheck=!e.isCheck,l.value.cityId="",l.value.districtId="",t.value.districtList.forEach(c=>{c.isCheck=!1});return}t.value.cityList.forEach(c=>{c.isCheck=!1}),e.isCheck=!e.isCheck,l.value.cityId=e.id,P()}else a===2&&(t.value.districtList.forEach(c=>{c.id!==e.id?c.isCheck=!1:e.isCheck=!e.isCheck}),l.value.districtId=e.isCheck?e.id:"");console.log(e)};async function f(){try{const{data:e}=await ee();t.value.provinceList=e}catch(e){console.log(e)}}async function _(e=l.value.provinceId){if(e)try{if(t.value.oldCityListInfo.provinceId===e&&t.value.oldCityListInfo.cityList.length){t.value.cityList=JSON.parse(JSON.stringify(t.value.oldCityListInfo.cityList));return}const{data:a}=await te(e);t.value.oldCityListInfo.provinceId=e,t.value.oldCityListInfo.cityList=JSON.parse(JSON.stringify(a)),t.value.cityList=a}catch(a){console.log(a)}}async function k(e=l.value.cityId){if(e)try{if(t.value.oldDistrictList.cityId===e&&t.value.oldDistrictList.districtList.length){t.value.districtList=JSON.parse(JSON.stringify(t.value.oldDistrictList.districtList));return}const{data:a}=await ae(e);t.value.oldDistrictList.cityId=e,t.value.oldDistrictList.districtList=JSON.parse(JSON.stringify(a)),t.value.districtList=a}catch(a){console.log(a)}}function T(){l.value.cityId="",t.value.cityList=[]}function E(){l.value.districtId="",t.value.districtList=[]}const J=async()=>{let e=l.value.provinceId;e&&(T(),E(),await _(e))},P=async()=>{let e=l.value.cityId;e&&(E(),await k(e))},O=y([{label:g("search.noLimit"),value:["",""],isCheck:!0},{label:"0-3万円",value:[0,3e4],isCheck:!1},{label:"3-6万円",value:[3e4,6e4],isCheck:!1},{label:"6-12万円",value:[6e4,12e4],isCheck:!1},{label:"12-18万円",value:[12e4,18e4],isCheck:!1},{label:"18-24万円",value:[18e4,24e4],isCheck:!1}]);function F(e){O.value.forEach(a=>{e.label===a.label?(e.isCheck=!e.isCheck,l.value.minRent=e.isCheck?e.value[0]:"",l.value.maxRent=e.isCheck?e.value[1]:""):a.isCheck=!1})}const R=y([]);async function M(){try{const{data:e}=await se();R.value=(e==null?void 0:e.map(a=>({label:a.name,value:a.id,isCheck:!1})))||[]}catch(e){console.log(e)}}function V(e){R.value.forEach(a=>{e.label===a.label?(e.isCheck=!e.isCheck,l.value.paymentTypeId=e.isCheck?e.value:""):a.isCheck=!1})}const z=y(ce(g).map(e=>({...e,isCheck:!1})));function q(e){z.value.forEach(a=>{e.label===a.label?(e.isCheck=!e.isCheck,l.value.orderType=e.isCheck?e.value:""):a.isCheck=!1})}const x=()=>{var e;(e=p.value)==null||e.close(),console.log(l.value),console.log("props.confirmCallback",!!m.confirmCallback),m.confirmCallback&&m.confirmCallback(l.value)},$=()=>{var e;(e=p.value)==null||e.close()};return K(()=>{f(),M()}),(e,a)=>{const c=Q,D=U,S=Y,N=Z,A=W;return o(),w(A,{ref_key:"menuRef",ref:p},{default:i(()=>[n(D,{title:e.$t("search.area")},{default:i(()=>[r("div",re,[r("div",de,[r("div",ue,[(o(!0),h(C,null,b(t.value.provinceList,s=>(o(),h("div",{class:L(["mt-[5px]",{checked:s.isCheck}]),onClick:I=>u(s,0),key:s.id},d(s.name),11,fe))),128))]),r("div",ve,[(o(!0),h(C,null,b(t.value.cityList,s=>(o(),h("div",{class:L(["mt-[5px]",{checked:s.isCheck}]),onClick:I=>u(s,1),key:s.id},d(s.name),11,he))),128))]),r("div",pe,[(o(!0),h(C,null,b(t.value.districtList,s=>(o(),h("div",{class:L(["mt-[5px]",{checked:s.isCheck}]),onClick:I=>u(s,2),key:s.id},d(s.name),11,_e))),128))])]),r("div",ye,[n(c,{type:"default",size:"small",class:"basis-2/5",round:"",onClick:$},{default:i(()=>[v(d(e.$t("common.cancel")),1)]),_:1}),n(c,{type:"primary",size:"small",class:"basis-2/5",round:"",onClick:x},{default:i(()=>[v(d(e.$t("common.search")),1)]),_:1})])])]),_:1},8,["title"]),n(D,{title:e.$t("search.price")},{default:i(()=>[r("div",ke,[n(N,{gutter:"10",justify:"space-between",class:"mt-[5px]"},{default:i(()=>[(o(!0),h(C,null,b(O.value,s=>(o(),w(S,{class:L(["text-center border p-[4px] mt-[5px] transition-all",{"other-checked":s.isCheck}]),onClick:I=>F(s),key:s.label,span:"7"},{default:i(()=>[v(d(s.label),1)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),r("div",Ce,[n(c,{type:"default",size:"small",class:"basis-2/5",round:"",onClick:$},{default:i(()=>[v(d(e.$t("common.cancel")),1)]),_:1}),n(c,{type:"primary",size:"small",class:"basis-2/5",round:"",onClick:x},{default:i(()=>[v(d(e.$t("common.search")),1)]),_:1})])]),_:1},8,["title"]),n(D,{title:e.$t("search.paymentMethod")},{default:i(()=>[r("div",me,[n(N,{justify:"space-between",class:"mt-[5px]"},{default:i(()=>[(o(!0),h(C,null,b(R.value,s=>(o(),w(S,{class:L(["text-center border p-[4px] mt-[5px] transition-all",{"other-checked":s.isCheck}]),onClick:I=>V(s),key:s.label,span:"7"},{default:i(()=>[v(d(s.label),1)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),r("div",be,[n(c,{type:"default",size:"small",class:"basis-2/5",round:"",onClick:$},{default:i(()=>[v(d(e.$t("common.cancel")),1)]),_:1}),n(c,{type:"primary",size:"small",class:"basis-2/5",round:"",onClick:x},{default:i(()=>[v(d(e.$t("common.search")),1)]),_:1})])]),_:1},8,["title"]),n(D,{title:e.$t("search.sort")},{default:i(()=>[r("div",Le,[n(N,{gutter:"10",justify:"space-around",class:"mt-[5px]"},{default:i(()=>[(o(!0),h(C,null,b(z.value,s=>(o(),w(S,{class:L(["text-center border p-[4px] mt-[5px] transition-all",{"other-checked":s.isCheck}]),onClick:I=>q(s),key:s.label,span:"7"},{default:i(()=>[v(d(s.label),1)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),r("div",ge,[n(c,{type:"default",size:"small",class:"basis-2/5",round:"",onClick:$},{default:i(()=>[v(d(e.$t("common.cancel")),1)]),_:1}),n(c,{type:"primary",size:"small",class:"basis-2/5",round:"",onClick:x},{default:i(()=>[v(d(e.$t("common.search")),1)]),_:1})])]),_:1},8,["title"])]),_:1},512)}}});const we=B(Ie,[["__scopeId","data-v-6ecb9dba"]]),xe={class:"main-container"},$e=H({name:"Search"}),De=H({...$e,setup(j){const g=y({}),m=y(),p=y([]);function l(u){var _;let f={};for(let k in u)u[k]!==""&&(f[k]=u[k]);g.value=f,(_=m.value)==null||_.onRefresh()}async function t(u){var _;const{data:f}=await le({...g.value,...u});console.log("pageInfo.current",u.current),u.current===1?p.value=f.records:p.value=[...p.value,...f.records],(_=m.value)==null||_.setFinished(p.value.length>=f.total)}return(u,f)=>(o(),h(C,null,[f[0]||(f[0]=r("div",{class:"banner-image"},[r("img",{src:oe,alt:"房源搜索",class:"w-full"})],-1)),n(we,{"confirm-callback":l}),r("div",xe,[n(ie,{request:t,ref_key:"pullDownRefreshContainerRef",ref:m,class:"min-h-[70vh]"},{default:i(()=>{var _;return[(_=p.value)!=null&&_.length?(o(!0),h(C,{key:0},b(p.value,k=>(o(),w(ne,{key:k.id,data:k},null,8,["data"]))),128)):X("",!0)]}),_:1},512)])],64))}});const Te=B(De,[["__scopeId","data-v-cc9dbb59"]]);export{Te as default};
