import{d as S,x as H,r as B,S as v,K as x,a as i,o as F,h as O,i as o,e as r,b as c,O as T,a1 as U,a0 as j}from"./index-713ae778.js";import{u as q}from"./useHandleData-f763eae5.js";import{g as $,u as K,a as z,d as G,b as J,c as Q}from"./index-99c15efc.js";import{A as b}from"./constEnums-bbb5bb0e.js";import"./index-4a51e267.js";function u(s){return typeof s=="function"||Object.prototype.toString.call(s)==="[object Object]"&&!j(s)}const te=S({__name:"apartmentManagement",setup(s){const p=H(),l=B(),a=v({provinceList:[],provinceId:"",cityList:[],cityId:"",districtList:[],districtId:""}),f=[{prop:"provinceId",label:"省",isShow:!1,fieldNames:{label:"name",value:"id"},search:{el:"select",render:()=>{let e;return r(i("el-select"),{modelValue:a.provinceId,"onUpdate:modelValue":t=>a.provinceId=t,placeholder:"请选择省",clearable:!0,key:"provinceId",onChange:_,onClear:L},u(e=a.provinceList.map(t=>r(i("el-option"),{key:t.id,label:t.name,value:t.id},null)))?e:{default:()=>[e]})}}},{prop:"cityId",label:"都市",isShow:!1,fieldNames:{label:"name",value:"id"},search:{el:"select",key:"cityId",render:()=>{let e;return r(i("el-select"),{modelValue:a.cityId,"onUpdate:modelValue":t=>a.cityId=t,placeholder:"请选择都市",clearable:!0,key:"cityId",onChange:k,onClear:E},u(e=a.cityList.map(t=>r(i("el-option"),{key:t.id,label:t.name,value:t.id},null)))?e:{default:()=>[e]})}}},{prop:"districtId",label:"エリア",isShow:!1,fieldNames:{label:"name",value:"id"},search:{el:"select",key:"districtId",render:()=>{let e;return r(i("el-select"),{modelValue:a.districtId,"onUpdate:modelValue":t=>a.districtId=t,placeholder:"请选择エリア",clearable:!0,onChange:A,onClear:P},u(e=a.districtList.map(t=>r(i("el-option"),{key:t.id,label:t.name,value:t.id},null)))?e:{default:()=>[e]})}}},{prop:"name",label:"名前"},{prop:"addressDetail",label:"詳細住所"},{prop:"freeRoomCount",label:"空室数"},{prop:"totalRoomCount",label:"総部屋数"},{prop:"provinceName",label:"所在都道府県",render:({row:e})=>e.provinceName||"未設定"},{prop:"cityName",label:"所在市区町村",render:({row:e})=>e.cityName||"未設定"},{prop:"districtName",label:"所处エリア",render:({row:e})=>e.districtName||"未設定"},{prop:"phone",label:"連絡先"},{prop:"入居状態",label:"入居状態",render:({row:e})=>e.freeRoomCount===0?r(i("el-tag"),{type:"info"},{default:()=>[c("満室")]}):r(i("el-tag"),{type:"success"},{default:()=>[c("入居可能")]})},{prop:"isRelease",label:"公開状態",render:({row:e})=>r(i("el-switch"),{"active-value":b.RELEASED,"inactive-value":b.NOT_RELEASED,modelValue:e.isRelease,"onUpdate:modelValue":t=>e.isRelease=t,onChange:()=>K(e.id,e.isRelease)},null)},{prop:"operation",label:"操作",fixed:"right",width:230}],h=v({});async function I(){var e;try{const{data:t}=await z();a.provinceList=t,(e=l.value)==null||e.enumMap.set("provinceId",a.provinceList)}catch(t){console.log(t)}}async function C(e){var t;try{const{data:n}=await J(e);a.cityList=n,(t=l.value)==null||t.enumMap.set("cityId",a.cityList)}catch(n){console.log(n)}}async function g(e){var t;try{const{data:n}=await Q(e);a.districtList=n,(t=l.value)==null||t.enumMap.set("districtId",a.districtList)}catch(n){console.log(n)}}function m(){var e;a.cityId="",a.cityList=[],(e=l.value)==null||e.enumMap.set("cityId",[]),l.value.searchParam.cityId=""}function d(){var e;a.districtId="",a.districtList=[],(e=l.value)==null||e.enumMap.set("districtId",[]),l.value.searchParam.districtId=""}const _=async()=>{let e=l.value.searchParam.provinceId;e&&(m(),d(),await C(e))},L=()=>{a.provinceId="",l.value.searchParam.provinceId="",m(),d()},k=async()=>{let e=l.value.searchParam.cityId;e&&(d(),await g(e))},E=()=>{console.log("清空都市"),a.cityId="",l.value.searchParam.cityId="",d()},A=async()=>{console.log("エリア改变")},P=()=>{console.log("清空エリア"),a.districtId="",l.value.searchParam.districtId=""},N=e=>({list:e==null?void 0:e.records,total:e==null?void 0:e.total}),R=e=>{console.log("移動"),p.push({path:"/apartmentManagement/apartmentManagement/addOrEditApartment",query:{id:e.id}})},M=()=>{p.push({path:"/apartmentManagement/apartmentManagement/addOrEditApartment"})},V=async e=>{var t;await q(G,e.id,`削除${e.name}`),(t=l.value)==null||t.getTableList()};return x(()=>{I()}),(e,t)=>{const n=i("el-button"),w=i("el-card");return F(),O(w,null,{default:o(()=>[r(U,{ref_key:"proTable",ref:l,dataCallback:N,columns:f,requestApi:T($),initParam:h,stripe:!0},{tableHeader:o(()=>[r(n,{type:"primary",icon:"Plus",onClick:M},{default:o(()=>[c(" マンションを追加 ")]),_:1})]),operation:o(y=>[r(n,{type:"success",icon:"Edit",onClick:D=>R(y.row)},{default:o(()=>[c(" 編集 ")]),_:2},1032,["onClick"]),r(n,{type:"danger",icon:"Delete",onClick:D=>V(y.row)},{default:o(()=>[c(" 削除 ")]),_:2},1032,["onClick"])]),_:1},8,["requestApi","initParam"])]),_:1})}}});export{te as default};
