import{d as F,r as x,S as h,K as H,a as r,o as W,h as U,i as f,e as i,O as b,b as j,a1 as G,z as O,a0 as q}from"./index-713ae778.js";import{a as z,b as K,c as R,m as X}from"./index-99c15efc.js";import{h as c,g as u,i as m}from"./constEnums-bbb5bb0e.js";import{g as $,u as J}from"./index-d7cb5d61.js";import"./index-4a51e267.js";function o(I){return typeof I=="function"||Object.prototype.toString.call(I)==="[object Object]"&&!q(I)}const le=F({__name:"appointment",setup(I){const l=x(),a=h({provinceList:[],provinceId:"",cityList:[],cityId:"",districtList:[],districtId:"",apartmentList:[],apartmentId:""}),g=[{prop:"name",label:"名前",search:{el:"input",props:{placeholder:"请输入名前"}}},{prop:"phone",label:"携帯電話",search:{el:"input",props:{placeholder:"请输入携帯電話号"}}},{prop:"provinceId",label:"省",isShow:!1,fieldNames:{label:"name",value:"id"},search:{el:"select",render:()=>{let e;return i(r("el-select"),{modelValue:a.provinceId,"onUpdate:modelValue":t=>a.provinceId=t,placeholder:"请选择省",clearable:!0,key:"provinceId",onChange:A,onClear:P},o(e=a.provinceList.map(t=>i(r("el-option"),{key:t.id,label:t.name,value:t.id},null)))?e:{default:()=>[e]})}}},{prop:"cityId",label:"都市",isShow:!1,fieldNames:{label:"name",value:"id"},search:{el:"select",key:"cityId",render:()=>{let e;return i(r("el-select"),{modelValue:a.cityId,"onUpdate:modelValue":t=>a.cityId=t,placeholder:"请选择都市",clearable:!0,key:"cityId",onChange:w,onClear:E},o(e=a.cityList.map(t=>i(r("el-option"),{key:t.id,label:t.name,value:t.id},null)))?e:{default:()=>[e]})}}},{prop:"districtId",label:"エリア",isShow:!1,fieldNames:{label:"name",value:"id"},search:{el:"select",key:"districtId",render:()=>{let e;return i(r("el-select"),{modelValue:a.districtId,"onUpdate:modelValue":t=>a.districtId=t,placeholder:"请选择エリア",clearable:!0,onChange:V,onClear:N},o(e=a.districtList.map(t=>i(r("el-option"),{key:t.id,label:t.name,value:t.id},null)))?e:{default:()=>[e]})}}},{prop:"apartmentId",label:"アパート",isShow:!1,fieldNames:{label:"name",value:"id"},search:{el:"select",key:"apartmentId",render:()=>{let e;return i(r("el-select"),{modelValue:a.apartmentId,"onUpdate:modelValue":t=>a.apartmentId=t,placeholder:"请选择アパート",clearable:!0,onChange:D,onClear:M},o(e=a.apartmentList.map(t=>i(r("el-option"),{key:t.id,label:t.name,value:t.id},null)))?e:{default:()=>[e]})}}},{prop:"apartmentInfo.provinceName",label:"所处省"},{prop:"apartmentInfo.cityName",label:"所处都市"},{prop:"apartmentInfo.districtName",label:"所处エリア"},{prop:"apartmentInfo.name",label:"所处アパート"},{prop:"appointmentTime",label:"予約日時"},{prop:"additionalInfo",label:"備考"},{prop:"appointmentStatus",label:"予約状態",render:({row:e})=>{let t,n,d,s;switch(e.appointmentStatus){case c.WAITING:return i(r("el-tag"),{type:"success"},o(t=u(m,e.appointmentStatus))?t:{default:()=>[t]});case c.CANCELLED:return i(r("el-tag"),{type:"warning"},o(n=u(m,e.appointmentStatus))?n:{default:()=>[n]});case c.VIEWED:return i(r("el-tag"),{type:"info"},o(d=u(m,e.appointmentStatus))?d:{default:()=>[d]});case c.EXPIRED:return i(r("el-tag"),{type:"danger"},o(s=u(m,e.appointmentStatus))?s:{default:()=>[s]});default:return i(r("el-tag"),{type:"info"},{default:()=>[u(m,e.appointmentStatus)||"—"]})}}},{prop:"operation",label:"操作",fixed:"right",width:150}],C=h({});async function L(){var e;try{const{data:t}=await z();a.provinceList=t,(e=l.value)==null||e.enumMap.set("provinceId",a.provinceList)}catch(t){console.log(t)}}async function _(e){var t;try{const{data:n}=await K(e);a.cityList=n,(t=l.value)==null||t.enumMap.set("cityId",a.cityList)}catch(n){console.log(n)}}async function k(e){var t;try{const{data:n}=await R(e);a.districtList=n,(t=l.value)==null||t.enumMap.set("districtId",a.districtList)}catch(n){console.log(n)}}async function S(e){var t;try{const{data:n}=await X(e);a.apartmentList=n,(t=l.value)==null||t.enumMap.set("apartmentId",a.apartmentList)}catch(n){console.log(n)}}function v(){var e;a.cityId="",a.cityList=[],(e=l.value)==null||e.enumMap.set("cityId",[]),l.value.searchParam.cityId=""}function y(){var e;a.districtId="",a.districtList=[],(e=l.value)==null||e.enumMap.set("districtId",[]),l.value.searchParam.districtId=""}function p(){var e;a.apartmentId="",a.apartmentList=[],(e=l.value)==null||e.enumMap.set("apartmentId",[]),l.value.searchParam.apartmentId=""}const A=async()=>{let e=l.value.searchParam.provinceId;e&&(v(),y(),p(),await _(e))},P=()=>{a.provinceId="",l.value.searchParam.provinceId="",v(),y(),p()},w=async()=>{let e=l.value.searchParam.cityId;e&&(y(),p(),await k(e))},E=()=>{console.log("清空都市"),a.cityId="",l.value.searchParam.cityId="",y(),p()},V=async()=>{let e=l.value.searchParam.districtId;e&&(p(),await S(e))},N=()=>{console.log("清空エリア"),a.districtId="",l.value.searchParam.districtId="",p()},D=async()=>{console.log("アパート改变")},M=()=>{console.log("清空アパート"),a.apartmentId="",l.value.searchParam.apartmentId=""},B=e=>({list:e==null?void 0:e.records,total:e==null?void 0:e.total}),T=async e=>{var t;try{await J(e.id,c.VIEWED),(t=l.value)==null||t.getTableList(),O.success("操作が成功しました")}catch(n){console.log(n)}};return H(()=>{L()}),(e,t)=>{const n=r("el-button"),d=r("el-card");return W(),U(d,null,{default:f(()=>[i(G,{ref_key:"proTable",ref:l,dataCallback:B,columns:g,requestApi:b($),initParam:C,stripe:!0},{operation:f(s=>[i(n,{type:s.row.appointmentStatus===b(c).WAITING?"primary":"info",icon:"View",disabled:s.row.appointmentStatus!==b(c).WAITING,onClick:Q=>T(s.row)},{default:f(()=>[j(" 内見案内 ")]),_:2},1032,["type","disabled","onClick"])]),_:1},8,["requestApi","initParam"])]),_:1})}}});export{le as default};
