import{a as oe,o as ne,p as re,b as de,c as ie,m as se}from"./index-99c15efc.js";import{d as ue,f as me,x as ce,r as _,S as E,w as pe,K as fe,a as s,o as i,h as m,i as r,l as V,t as H,e as o,c as f,B as I,F as y,b as B,O as Ie,z as S,_ as ye}from"./index-713ae778.js";import{j as ve,m as be}from"./constEnums-bbb5bb0e.js";import{c as ge,e as _e,s as Ve}from"./index-d7cb5d61.js";import"./index-4a51e267.js";const Ce={class:"card-header"},Le={class:"flex-center"},ke={class:"flex-center m-t-20"},we=ue({__name:"addOrEditAgreement",setup(De){const C=me(),L=ce(),k=_(),n=_({id:"",userId:"",name:"",phone:"",identificationNumber:"",apartmentId:"",roomId:"",leaseStartDate:"",leaseEndDate:"",leaseTermId:"",rent:0,deposit:0,paymentTypeId:"",status:ve.WAITING,sourceType:be.NEW,additionalInfo:""}),R=E({roomNumber:[{required:!0,message:"请输入部屋号",trigger:"blur"}]}),a=E({provinceList:[],provinceId:"",cityList:[],cityId:"",districtList:[],districtId:"",apartmentList:[],apartmentId:"",roomList:[],roomId:""});pe(()=>a,l=>{n.value.apartmentId=l.apartmentId,n.value.roomId=l.roomId},{immediate:!0,deep:!0});async function O(){try{const{data:l}=await oe();a.provinceList=l}catch(l){console.log(l)}}async function w(l=a.provinceId){try{const{data:e}=await de(l);a.cityList=e}catch(e){console.log(e)}}async function D(l=a.cityId){try{const{data:e}=await ie(l);a.districtList=e}catch(e){console.log(e)}}async function h(l=a.districtId){try{const{data:e}=await se(l);a.apartmentList=e}catch(e){console.log(e)}}async function U(l=a.apartmentId){try{const{data:e}=await _e(l);a.roomList=e}catch(e){console.log(e)}}function Y(){a.cityId="",a.cityList=[]}function g(){a.districtId="",a.districtList=[]}function v(){a.apartmentId="",a.apartmentList=[]}function u(){a.roomId="",a.roomList=[]}const $=async()=>{let l=a.provinceId;l&&(Y(),g(),v(),u(),await w(l))},q=()=>{a.provinceId="",Y(),g(),v(),u()},F=async()=>{let l=a.cityId;l&&(g(),v(),u(),await D(l))},P=()=>{console.log("都市選択をクリア"),a.cityId="",g(),v(),u()},W=async()=>{let l=a.districtId;l&&(v(),u(),await h(l))},j=()=>{console.log("エリア選択をクリア"),a.districtId="",v(),u()},z=async()=>{console.log("アパートが変わり");let l=a.apartmentId;l&&(u(),await U(l))},G=()=>{console.log("アパートを空にし"),a.apartmentId="",u()},K=async()=>{console.log("部屋改变")},J=()=>{console.log("清空部屋"),a.roomId=""},x=_([]),M=_([]);async function Q(){try{const{data:l}=await ne();x.value=l}catch(l){console.log(l)}}async function X(){try{const{data:l}=await re();M.value=l}catch(l){console.log(l)}}async function Z(l){try{const{data:e}=await ge(l);n.value=e,a.provinceId=e.apartmentInfo.provinceId,a.cityId=e.apartmentInfo.cityId,a.districtId=e.apartmentInfo.districtId,a.apartmentId=e.apartmentId,a.roomId=e.roomId,e.apartmentInfo.provinceId&&await w(e.apartmentInfo.provinceId),e.apartmentInfo.cityId&&await D(e.apartmentInfo.cityId),e.apartmentInfo.districtId&&await h(e.apartmentInfo.districtId),e.apartmentId&&await U(e.apartmentId)}catch(e){console.log(e)}}async function ee(){try{await Ve(n.value),S.success("操作が成功しました"),L.back()}catch(l){console.log(l)}}function te(){var l;(l=k.value)==null||l.validate(async e=>{if(e)await ee();else return S.error("入力内容に誤りがあります。，確認してください"),!1})}return fe(()=>{var l;O(),Q(),X(),(l=C.query)!=null&&l.id&&Z(C.query.id)}),(l,e)=>{const b=s("el-input"),d=s("el-form-item"),c=s("el-option"),p=s("el-select"),A=s("el-date-picker"),T=s("el-input-number"),ae=s("el-form"),N=s("el-button"),le=s("el-card");return i(),m(le,null,{header:r(()=>[V("div",Ce,[V("span",null,H(n.value.id?"編集":"新規追加")+"賃貸契約",1)])]),default:r(()=>[o(ae,{ref_key:"apartmentFormRef",ref:k,model:n.value,rules:R,"label-width":"120px",style:{"max-width":"1000px"},"status-icon":""},{default:r(()=>[o(d,{label:"ユーザーID",prop:"userId"},{default:r(()=>[o(b,{modelValue:n.value.userId,"onUpdate:modelValue":e[0]||(e[0]=t=>n.value.userId=t),modelModifiers:{trim:!0},placeholder:"请输入ユーザーID"},null,8,["modelValue"])]),_:1}),o(d,{label:"名前",prop:"name"},{default:r(()=>[o(b,{modelValue:n.value.name,"onUpdate:modelValue":e[1]||(e[1]=t=>n.value.name=t),modelModifiers:{trim:!0},placeholder:"请输入名前"},null,8,["modelValue"])]),_:1}),o(d,{label:"携帯電話番号",prop:"phone"},{default:r(()=>[o(b,{modelValue:n.value.phone,"onUpdate:modelValue":e[2]||(e[2]=t=>n.value.phone=t),modelModifiers:{trim:!0},placeholder:"请输入携帯電話番号"},null,8,["modelValue"])]),_:1}),o(d,{label:"住民登録番号",prop:"identificationNumber"},{default:r(()=>[o(b,{modelValue:n.value.identificationNumber,"onUpdate:modelValue":e[3]||(e[3]=t=>n.value.identificationNumber=t),modelModifiers:{trim:!0},placeholder:"请输入住民登録番号"},null,8,["modelValue"])]),_:1}),o(d,{label:"部屋",required:""},{default:r(()=>[V("div",Le,[o(d,{prop:"provinceId"},{default:r(()=>[o(p,{modelValue:a.provinceId,"onUpdate:modelValue":e[4]||(e[4]=t=>a.provinceId=t),placeholder:"省を選択してください。",clearable:"",onChange:$,onClear:q},{default:r(()=>[(i(!0),f(y,null,I(a.provinceList,t=>(i(),m(c,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(d,{prop:"cityId"},{default:r(()=>[o(p,{modelValue:a.cityId,"onUpdate:modelValue":e[5]||(e[5]=t=>a.cityId=t),placeholder:"都市を選択してください",clearable:"",onChange:F,onClear:P},{default:r(()=>[(i(!0),f(y,null,I(a.cityList,t=>(i(),m(c,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(d,{prop:"districtId"},{default:r(()=>[o(p,{modelValue:a.districtId,"onUpdate:modelValue":e[6]||(e[6]=t=>a.districtId=t),placeholder:"エリアを選択してください",clearable:"",onChange:W,onClear:j},{default:r(()=>[(i(!0),f(y,null,I(a.districtList,t=>(i(),m(c,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(d,{prop:"apartmentId"},{default:r(()=>[o(p,{modelValue:a.apartmentId,"onUpdate:modelValue":e[7]||(e[7]=t=>a.apartmentId=t),placeholder:"アパートをお願いし",clearable:"",filterable:"",onChange:z,onClear:G},{default:r(()=>[(i(!0),f(y,null,I(a.apartmentList,t=>(i(),m(c,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(d,{prop:"roomId"},{default:r(()=>[o(p,{modelValue:a.roomId,"onUpdate:modelValue":e[8]||(e[8]=t=>a.roomId=t),placeholder:"请选择部屋",clearable:"",filterable:"",onChange:K,onClear:J},{default:r(()=>[(i(!0),f(y,null,I(a.roomList,t=>(i(),m(c,{key:t.id,label:t.roomNumber,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})])]),_:1}),o(d,{label:"開始日",prop:"leaseStartDate"},{default:r(()=>[o(A,{modelValue:n.value.leaseStartDate,"onUpdate:modelValue":e[9]||(e[9]=t=>n.value.leaseStartDate=t),type:"date",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",placeholder:"開始日",clearable:""},null,8,["modelValue"])]),_:1}),o(d,{label:"終了日",prop:"leaseEndDate"},{default:r(()=>[o(A,{modelValue:n.value.leaseEndDate,"onUpdate:modelValue":e[10]||(e[10]=t=>n.value.leaseEndDate=t),type:"date",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",placeholder:"終了日",clearable:""},null,8,["modelValue"])]),_:1}),o(d,{label:"支払い方法",prop:"paymentTypeIds"},{default:r(()=>[o(p,{style:{width:"100%"},modelValue:n.value.paymentTypeId,"onUpdate:modelValue":e[11]||(e[11]=t=>n.value.paymentTypeId=t),placeholder:"请选择支払い方法",clearable:""},{default:r(()=>[(i(!0),f(y,null,I(x.value,t=>(i(),m(c,{key:t.id,label:`${t.name} (${t.additionalInfo})`,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(d,{label:"レンタル期間を選択します。",prop:"leaseTermIds"},{default:r(()=>[o(p,{style:{width:"100%"},modelValue:n.value.leaseTermId,"onUpdate:modelValue":e[12]||(e[12]=t=>n.value.leaseTermId=t),placeholder:"レンタル期間をお願いします。",clearable:""},{default:r(()=>[(i(!0),f(y,null,I(M.value,t=>(i(),m(c,{key:t.id,label:`${t.monthCount}${t.unit}`,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(d,{label:"家賃（元/げつ）",prop:"rent"},{default:r(()=>[o(T,{modelValue:n.value.rent,"onUpdate:modelValue":e[13]||(e[13]=t=>n.value.rent=t),step:1,"step-strictly":""},null,8,["modelValue"])]),_:1}),o(d,{label:"敷金（元）",prop:"deposit"},{default:r(()=>[o(T,{modelValue:n.value.deposit,"onUpdate:modelValue":e[14]||(e[14]=t=>n.value.deposit=t),step:1,"step-strictly":""},null,8,["modelValue"])]),_:1}),o(d,{label:"備考",prop:"additionalInfo"},{default:r(()=>[o(b,{modelValue:n.value.additionalInfo,"onUpdate:modelValue":e[15]||(e[15]=t=>n.value.additionalInfo=t),modelModifiers:{trim:!0},type:"textarea",placeholder:"请输入備考"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),V("div",ke,[o(N,{style:{width:"150px"},type:"info",onClick:e[16]||(e[16]=t=>Ie(L).back())},{default:r(()=>[B(" キャンセル ")]),_:1}),o(N,{style:{width:"150px"},type:"primary",onClick:te},{default:r(()=>[B(H(n.value.id?"保存し":"新規追加"),1)]),_:1})])]),_:1})}}});const Ae=ye(we,[["__scopeId","data-v-5f9bcb90"]]);export{Ae as default};
